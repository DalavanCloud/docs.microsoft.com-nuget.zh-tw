---
title: 安裝 NuGet 套件的方式 | Microsoft Docs
author: kraigb
ms.author: kraigb
manager: ghogen
ms.date: 02/12/2018
ms.topic: overview
ms.prod: nuget
ms.technology: ''
description: 描述將 NuGet 套件安裝到專案的程序，包括在磁碟上及適用的專案檔會發生什麼情況。
keywords: 安裝 NuGet, NuGet 套件耗用量, 安裝 NuGet 套件, NuGet 套件參考
ms.reviewer:
- karann-msft
- unniravindranathan
ms.workload:
- dotnet
- aspnet
ms.openlocfilehash: b8cce7bd6c1bd73eb018b8891ddd72b2f4432d55
ms.sourcegitcommit: beb229893559824e8abd6ab16707fd5fe1c6ac26
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/28/2018
---
# <a name="different-ways-to-install-a-nuget-package"></a><span data-ttu-id="c7100-104">安裝 NuGet 套件的不同方式</span><span class="sxs-lookup"><span data-stu-id="c7100-104">Different ways to install a NuGet Package</span></span>

<span data-ttu-id="c7100-105">NuGet 套件會使用下表中的任一種方法來下載並安裝 (如果您尚未安裝這些項目，請參閱[安裝 NuGet 用戶端工具](../install-nuget-client-tools.md))。</span><span class="sxs-lookup"><span data-stu-id="c7100-105">NuGet packages are downloaded and installed using any of the methods in the following table (see [Install NuGet client tools](../install-nuget-client-tools.md) if you don't have these installed already).</span></span> <span data-ttu-id="c7100-106">套件可能會從快取擷取而不是下載。</span><span class="sxs-lookup"><span data-stu-id="c7100-106">The package may be retrieved from a cache instead of downloaded.</span></span>

| <span data-ttu-id="c7100-107">方法</span><span class="sxs-lookup"><span data-stu-id="c7100-107">Method</span></span> | <span data-ttu-id="c7100-108">描述</span><span class="sxs-lookup"><span data-stu-id="c7100-108">Description</span></span> |
| --- | --- |
| <span data-ttu-id="c7100-109">dotnet.exe CLI</span><span class="sxs-lookup"><span data-stu-id="c7100-109">dotnet.exe CLI</span></span><br/>`dotnet add package <package_name>` | <span data-ttu-id="c7100-110">(所有平台) 擷取 \<package_name\> 所識別的套件、在目前目錄的資料夾中展開其內容，並將參考新增到專案檔。</span><span class="sxs-lookup"><span data-stu-id="c7100-110">(All platforms) Retrieves the package identified by \<package_name\>, expands its contents into a folder in the current directory, and adds a reference to the project file.</span></span> <span data-ttu-id="c7100-111">此外，也會擷取並安裝相依性。</span><span class="sxs-lookup"><span data-stu-id="c7100-111">Also retrieves and installs dependencies.</span></span><ul><li>[<span data-ttu-id="c7100-112">安裝並使用套件 (dotnet CLI)</span><span class="sxs-lookup"><span data-stu-id="c7100-112">Install and use a package (dotnet CLI)</span></span>](../quickstart/install-and-use-a-package-using-the-dotnet-cli.md)</li><li>[<span data-ttu-id="c7100-113">dotnet add package 命令</span><span class="sxs-lookup"><span data-stu-id="c7100-113">dotnet add package command</span></span>](/dotnet/core/tools/dotnet-add-package)</li></ul> |
| <span data-ttu-id="c7100-114">套件管理員 UI (Visual Studio)</span><span class="sxs-lookup"><span data-stu-id="c7100-114">Package Manager UI (Visual Studio)</span></span> | <span data-ttu-id="c7100-115">(Windows 和 Mac) 提供 UI，透過該 UI 可從指定套件來源瀏覽、選取套件及其相依性並安裝至專案。</span><span class="sxs-lookup"><span data-stu-id="c7100-115">(Windows and Mac) Provides a UI through which you can browse, select, and install packages and their dependencies into a project from a specified package source.</span></span> <span data-ttu-id="c7100-116">將對於已安裝套件的參考新增至專案檔。</span><span class="sxs-lookup"><span data-stu-id="c7100-116">Adds references to installed packages to the project file.</span></span><ul><li>[<span data-ttu-id="c7100-117">安裝並使用套件 (Visual Studio)</span><span class="sxs-lookup"><span data-stu-id="c7100-117">Install and use a package (Visual Studio)</span></span>](../quickstart/install-and-use-a-package-in-visual-studio.md)</li><li>[<span data-ttu-id="c7100-118">套件管理員 UI 參考 (Windows)</span><span class="sxs-lookup"><span data-stu-id="c7100-118">Package Manager UI reference (Windows)</span></span>](../tools/package-manager-ui.md)</li><li>[<span data-ttu-id="c7100-119">在專案中包含 NuGet 套件 (Mac)</span><span class="sxs-lookup"><span data-stu-id="c7100-119">Including a NuGet package in your project (Mac)</span></span>](/visualstudio/mac/nuget-walkthrough)</li></ul> |
| <span data-ttu-id="c7100-120">套件管理員主控台 (Visual Studio)</span><span class="sxs-lookup"><span data-stu-id="c7100-120">Package Manager Console (Visual Studio)</span></span><br/>`Install-Package <package_name>` | <span data-ttu-id="c7100-121">(僅限 Windows) 從所選來源擷取 \<package_name\> 所識別的套件並安裝到方案中的指定專案，然後將參考新增到專案檔。</span><span class="sxs-lookup"><span data-stu-id="c7100-121">(Windows only) Retrieves and installs the package identified by \<package_name\> from a selected source into a specified project in the solution, then adds a reference to the project file.</span></span> <span data-ttu-id="c7100-122">此外，也會擷取並安裝相依性。</span><span class="sxs-lookup"><span data-stu-id="c7100-122">Also retrieves and installs dependencies.</span></span><ul><li>[<span data-ttu-id="c7100-123">安裝並使用套件 (Visual Studio)</span><span class="sxs-lookup"><span data-stu-id="c7100-123">Install and use a package (Visual Studio)</span></span>](../quickstart/install-and-use-a-package-in-visual-studio.md)</li><li>[<span data-ttu-id="c7100-124">套件管理員主控台指南</span><span class="sxs-lookup"><span data-stu-id="c7100-124">Package Manager Console guide</span></span>](../tools/package-manager-console.md)</li></ul> |
| <span data-ttu-id="c7100-125">nuget.exe CLI</span><span class="sxs-lookup"><span data-stu-id="c7100-125">nuget.exe CLI</span></span><br/>`nuget install <package_name>` | <span data-ttu-id="c7100-126">(所有平台) 擷取 \<package_name\> 所識別的套件，並在目前目錄的資料夾中展開其內容；也可以擷取 `packages.config` 檔案中列出的所有套件。</span><span class="sxs-lookup"><span data-stu-id="c7100-126">(All platforms) Retrieves the package identified by \<package_name\> and expands its contents into a folder in the current directory; can also retrieve all packages listed in a `packages.config` file.</span></span> <span data-ttu-id="c7100-127">另外也會擷取並安裝相依性，但不會對專案檔或 `packages.config` 進行任何變更。</span><span class="sxs-lookup"><span data-stu-id="c7100-127">Also retrieves and installs dependencies, but makes no changes to project files or `packages.config`.</span></span><ul><li>[<span data-ttu-id="c7100-128">安裝命令</span><span class="sxs-lookup"><span data-stu-id="c7100-128">install command</span></span>](../tools/cli-ref-install.md)</li></ul> |

## <a name="what-happens-when-a-package-is-installed"></a><span data-ttu-id="c7100-129">安裝套件後會發生什麼事</span><span class="sxs-lookup"><span data-stu-id="c7100-129">What happens when a package is installed</span></span>

<span data-ttu-id="c7100-130">簡單地說，不同的 NuGet 工具通常會在專案檔或 `packages.config` 中建立套件的參考，然後執行套件還原，從而有效地安裝套件。</span><span class="sxs-lookup"><span data-stu-id="c7100-130">Simply said, the different NuGet tools typically create a reference to a package in the project file or `packages.config`, then perform a package restore, which effectively installs the package.</span></span> <span data-ttu-id="c7100-131">例外狀況是 `nuget install`，它只會將套件展開到 `packages` 資料夾，且不會修改其他任何檔案。</span><span class="sxs-lookup"><span data-stu-id="c7100-131">The exception is `nuget install`, which only expands the package into a `packages` folder and does not modify any other files.</span></span>

<span data-ttu-id="c7100-132">一般程序如下：</span><span class="sxs-lookup"><span data-stu-id="c7100-132">The general process is as follows:</span></span>

1. <span data-ttu-id="c7100-133">(除 `nuget.exe` 外的所有工具) 將套件識別碼和版本記錄到專案檔或 `packages.config` 中。</span><span class="sxs-lookup"><span data-stu-id="c7100-133">(All tools except `nuget.exe`) Record the package identifer and version into the project file or `packages.config`.</span></span>

1. <span data-ttu-id="c7100-134">取得套件：</span><span class="sxs-lookup"><span data-stu-id="c7100-134">Acquire the package:</span></span>
    - <span data-ttu-id="c7100-135">檢查套件 (依據確切的識別碼和版本號碼) 是否已安裝在 *global-packages* 資料夾中，如[管理全域套件和快取資料夾](managing-the-global-packages-and-cache-folders.md)中所述。</span><span class="sxs-lookup"><span data-stu-id="c7100-135">Check if the package (by exact identifer and version number) is already installed in the *global-packages* folder as described on [Managing the global packages and cache folders](managing-the-global-packages-and-cache-folders.md).</span></span>

    - <span data-ttu-id="c7100-136">如果套件不在 *global-packages* 資料夾中，則會嘗試從[組態檔](Configuring-NuGet-Behavior.md)中所列的來源擷取套件。</span><span class="sxs-lookup"><span data-stu-id="c7100-136">If the package is not in the *global-packages* folder, attempt to retrieve it from the sources listed listed in the [configuration files](Configuring-NuGet-Behavior.md).</span></span> <span data-ttu-id="c7100-137">對於線上來源，除非已使用 `nuget.exe` 命令指定 `-NoCache`，或已使用 `dotnet restore` 指定 `--no-cache`，否則會先嘗試從快取擷取套件。</span><span class="sxs-lookup"><span data-stu-id="c7100-137">For online sources, attempt first to retrieve the package from the cache unless `-NoCache` is specified with `nuget.exe` commands or `--no-cache` is specified with `dotnet restore`.</span></span> <span data-ttu-id="c7100-138">(Visual Studio 和 `dotnet add package` 一律使用快取。)如果是從快取使用套件，則輸出中會出現 "CACHE"。</span><span class="sxs-lookup"><span data-stu-id="c7100-138">(Visual Studio and `dotnet add package` always use the cache.) If a package is used from the cache, "CACHE" appears in the output.</span></span> <span data-ttu-id="c7100-139">快取的到期時間為 30 分鐘。</span><span class="sxs-lookup"><span data-stu-id="c7100-139">The cache has an expiration time of 30 minutes.</span></span>

    - <span data-ttu-id="c7100-140">如果套件不在快取中，則會嘗試從組態中所列的來源下載套件。</span><span class="sxs-lookup"><span data-stu-id="c7100-140">If the package is not in the cache, attempt to download it from the sources listed in the configuration.</span></span> <span data-ttu-id="c7100-141">如果已下載套件，輸出中會出現 "GET" 和 "OK"。</span><span class="sxs-lookup"><span data-stu-id="c7100-141">If a package is downloaded, "GET" and "OK" appear in the output.</span></span>

    - <span data-ttu-id="c7100-142">如果無法從任何來源成功取得套件，此時安裝會失敗，並出現錯誤，例如 [NU1103](../reference/errors-and-warnings.md#nu1103)。</span><span class="sxs-lookup"><span data-stu-id="c7100-142">If the package cannot be successfully acquired from any sources, installation fails at this point with an error such as [NU1103](../reference/errors-and-warnings.md#nu1103).</span></span> <span data-ttu-id="c7100-143">請注意，來自 `nuget.exe` 命令的錯誤只會顯示所檢查的最後一個來源，但表示無法從任何來源使用套件。</span><span class="sxs-lookup"><span data-stu-id="c7100-143">Note that errors from `nuget.exe` commands show only the last source checked, but implies that the package wasn't available from any source.</span></span>

    <span data-ttu-id="c7100-144">取得套件時，可能套用 NuGet 組態中的來源順序為：</span><span class="sxs-lookup"><span data-stu-id="c7100-144">When acquiring the package, the order of sources in the NuGet configuration may apply:</span></span>
      - <span data-ttu-id="c7100-145">若為使用 PackageReference 格式的專案，NuGet 先檢查來源本機資料夾和網路共用，然後才檢查 HTTP 來源。</span><span class="sxs-lookup"><span data-stu-id="c7100-145">For projects using the PackageReference format, NuGet checks sources local folder and network shares before checking HTTP sources.</span></span>
      - <span data-ttu-id="c7100-146">若為使用 `packages.config` 管理格式的專案，NuGet 會使用組態中的來源順序。</span><span class="sxs-lookup"><span data-stu-id="c7100-146">For projects using the `packages.config` management format, NuGet uses the order of the sources in the configuration.</span></span> <span data-ttu-id="c7100-147">例外狀況是還原作業，在此情況下，會忽略來源順序，而且 NuGet 會使用先回應之來源的套件。</span><span class="sxs-lookup"><span data-stu-id="c7100-147">An exception is restore operations, in which case source ordering is ignored and NuGet uses the package from whichever source responds first.</span></span>
      - <span data-ttu-id="c7100-148">一般而言，NuGet 檢查來源的順序並不重要，因為不管來源為何，只要套件具有相同的識別碼和版本號碼，便會是完全相同的套件。</span><span class="sxs-lookup"><span data-stu-id="c7100-148">In general, the order in which NuGet checks sources isn't particularly meaningful, because any given package with a specific identifier and version number is exactly the same on whatever source it's found.</span></span>

1. <span data-ttu-id="c7100-149">(除 `nuget.exe` 外的所有工具) 將套件複本和其他資訊儲存在 *http-cache* 資料夾中，如[管理全域套件和快取資料夾](managing-the-global-packages-and-cache-folders.md)中所述。</span><span class="sxs-lookup"><span data-stu-id="c7100-149">(All tools except `nuget.exe`) Save a copy of the package and other information in the *http-cache* folder as described on [Managing the global packages and cache folders](managing-the-global-packages-and-cache-folders.md).</span></span>

1. <span data-ttu-id="c7100-150">如果已下載，則將套件安裝到每個使用者的 *global-packages* 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="c7100-150">If downloaded, install the package into the per-user *global-packages* folder.</span></span> <span data-ttu-id="c7100-151">NuGet 會針對每個套件識別碼建立子資料夾，然後針對每個已安裝的套件版本建立子資料夾。</span><span class="sxs-lookup"><span data-stu-id="c7100-151">NuGet creates a subfolder for each package identifier, then creates subfolders for each installed version of the package.</span></span>

1. <span data-ttu-id="c7100-152">更新其他專案檔和資料夾：</span><span class="sxs-lookup"><span data-stu-id="c7100-152">Update other project files and folders:</span></span>

    - <span data-ttu-id="c7100-153">針對使用 PackageReference 的專案，更新儲存在 `obj/project.assets.json` 中的套件相依性關係圖。</span><span class="sxs-lookup"><span data-stu-id="c7100-153">For projects using PackageReference, update the package dependency graph stored in `obj/project.assets.json`.</span></span> <span data-ttu-id="c7100-154">套件內容本身不會複製到任何專案資料夾中。</span><span class="sxs-lookup"><span data-stu-id="c7100-154">Package contents themselves are not copied into any project folder.</span></span>
    - <span data-ttu-id="c7100-155">針對使用 `packages.config` 的專案，將符合專案之目標 Framework 的那些已展開套件部分複製到專案的 `packages` 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="c7100-155">For projects using `packages.config`, copy those parts of the expanded package that match the project's target framework into project's `packages` folder.</span></span> <span data-ttu-id="c7100-156">(當使用 `nuget install` 時，會複製整個已展開的套件，因為 `nuget.exe` 不會檢查專案檔來識別目標 Framework。)</span><span class="sxs-lookup"><span data-stu-id="c7100-156">(When using `nuget install`, the entire expanded package is copied because `nuget.exe` does not examine project files to identify the target framework.)</span></span>
    - <span data-ttu-id="c7100-157">如果套件使用[來源和組態檔轉換](../create-packages/source-and-config-file-transformations.md)，則更新 `app.config` 和/或 `web.config`。</span><span class="sxs-lookup"><span data-stu-id="c7100-157">Update `app.config` and/or `web.config` if the package uses [source and config file transformations](../create-packages/source-and-config-file-transformations.md).</span></span>

1. <span data-ttu-id="c7100-158">安裝任何下層相依性 (若專案中尚未存在)。</span><span class="sxs-lookup"><span data-stu-id="c7100-158">Install any down-level dependencies if not already present in the project.</span></span> <span data-ttu-id="c7100-159">此程序可能更新流程中的套件版本，如[相依性解析](../consume-packages/dependency-resolution.md)中所述。</span><span class="sxs-lookup"><span data-stu-id="c7100-159">This process might update package versions in the process, as described in [Dependency Resolution](../consume-packages/dependency-resolution.md).</span></span>

1. <span data-ttu-id="c7100-160">(僅限 Visual Studio) 在 Visual Studio 視窗中顯示套件的讀我檔案 (如果有的話)。</span><span class="sxs-lookup"><span data-stu-id="c7100-160">(Visual Studio only) Display the package's readme file, if available, in a Visual Studio window.</span></span>

## <a name="related-articles"></a><span data-ttu-id="c7100-161">相關文章</span><span class="sxs-lookup"><span data-stu-id="c7100-161">Related articles</span></span>

- [<span data-ttu-id="c7100-162">套件耗用量的概觀及工作流程</span><span class="sxs-lookup"><span data-stu-id="c7100-162">Overview and workflow of package consumption</span></span>](../consume-packages/overview-and-workflow.md)
- [<span data-ttu-id="c7100-163">尋找及選擇套件</span><span class="sxs-lookup"><span data-stu-id="c7100-163">Finding and choosing packages</span></span>](../consume-packages/finding-and-choosing-packages.md)
- [<span data-ttu-id="c7100-164">管理 NuGet 快取和 global-packages 資料夾</span><span class="sxs-lookup"><span data-stu-id="c7100-164">Managing the NuGet cache and global-packages folders</span></span>](managing-the-global-packages-and-cache-folders.md)
- [<span data-ttu-id="c7100-165">設定 NuGet 行為</span><span class="sxs-lookup"><span data-stu-id="c7100-165">Configuring NuGet behavior</span></span>](../consume-packages/configuring-nuget-behavior.md)
